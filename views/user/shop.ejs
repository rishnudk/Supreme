
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Untree.co">
  <link rel="shortcut icon" href="favicon.png">

  <meta name="description" content="" />
  <meta name="keywords" content="bootstrap, bootstrap4" />

  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
		<title>Supreme </title>




               <style>
        :root {
            --primary-color: #4F6367;
            --secondary-color: #B8D8D8;
            --accent-color: #FE5F55;
            --light-color: #F4F7F7;
            --dark-color: #2D3B3E;
            --text-color: #333333;
        }

        body {
            background-color: var(--light-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: var(--text-color);
        }

        .shop-header {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }






       /* Ensure the search container is not affected by external styles */
.search-container.custom-search {
    position: relative;
    max-width: 500px;
}

/* Style the input field specifically within .custom-search */
.search-container.custom-search .search-input {
    border: 1px solid var(--secondary-color) !important;
    border-radius: 25px !important;
    padding: 0.75rem 1rem !important;
    padding-right: 3rem !important;
    width: 100% !important;
    transition: all 0.3s ease-in-out;
    background-color: #fff; /* Ensure background is not overridden */
}

/* Keep focus styles consistent */
.search-container.custom-search .search-input:focus {
    outline: none !important;
    box-shadow: 0 0 0 2px var(--accent-color) !important;
    border-color: var(--accent-color) !important;
}

/* Prevent Bootstrap styles from affecting the button */
.search-container.custom-search .search-button {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    background: var(--accent-color);
    border: none !important;
    padding: 0.5rem;
    border-radius: 50%;
    cursor: pointer;
    transition: background 0.3s;
}

/* Style the search button icon */
.search-container.custom-search .search-button i {
    color: white !important;
    font-size: 1rem;
}

/* Add hover effect */
.search-container.custom-search .search-button:hover {
    background: var(--secondary-color);
}


       






        
        .sort-options {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .sort-options select {
            border: 1px solid var(--secondary-color);
            border-radius: 8px;
            padding: 0.5rem;
            background-color: white;
            color: var(--text-color);
        }

        .filter-container {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .filter-title {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--secondary-color);
        }

        .filter-section {
            margin-bottom: 2rem;
        }

        .filter-section label {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            cursor: pointer;
        }

        .filter-section input[type="checkbox"],
        .filter-section input[type="radio"] {
            margin-right: 0.5rem;
            accent-color: var(--accent-color);
        }

        .filter-section span {
            color: var(--accent-color);
            cursor: pointer;
            font-size: 0.9rem;
            display: block;
            margin-top: 0.5rem;
        }

        input[type="range"] {
            width: 100%;
            accent-color: var(--accent-color);
        }

        .product-card {
            background-color: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s, box-shadow 0.3s;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
        }

        .product-img-container {
            position: relative;
            overflow: hidden;
            padding-top: 75%; /* 4:3 aspect ratio */
        }

        .product-img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
        }

        .product-card:hover .product-img {
            transform: scale(1.05);
        }

        .product-info {
            padding: 1.5rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .product-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--dark-color);
        }

        .product-price {
            font-size: 1.2rem;
            color: var(--accent-color);
            font-weight: 700;
            margin-bottom: 0.75rem;
        }

        .product-category {
            font-size: 0.85rem;
            color: #777;
            margin-top: auto;
        }

        .btn-accent {
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 0.5rem 1.5rem;
            transition: all 0.3s;
        }

        .btn-accent:hover {
            background-color: #e5574e;
            color: white;
        }

        .pagination {
            margin-top: 2rem;
        }

        .page-link {
            color: var(--primary-color);
            border-color: var(--secondary-color);
        }

        .page-item.active .page-link {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
        }

        .page-link:hover {
            color: var(--accent-color);
        }

        .mobile-filter-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            z-index: 1000;
        }

        #mobile-filter {
            position: fixed;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: white;
            z-index: 1100;
            overflow-y: auto;
            transform: translateX(-100%);
            transition: transform 0.3s;
            padding: 1.5rem;
        }

        #mobile-filter.active {
            transform: translateX(0);
        }

        .mobile-filter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .filter-close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--dark-color);
        }

        @media (max-width: 991px) {
            .desktop-filter {
                display: none;
            }
        }

        @media (min-width: 992px) {
            .mobile-filter-btn {
                display: none;
            }
        }




        .product-price {
    font-size: 1.2em;
    color: #e74c3c; /* Discounted price in red */
}
.original-price {
    font-size: 0.9em;
    color: #666;
    margin-left: 5px;
}
    </style>
      
	
	</head>

	<body>

        <%- include('../partials/userNavbar') %>

	





		
 

	







        <div class="container py-4">
            <!-- Search and Sort Header -->
            <div class="shop-header">
                <div class="row align-items-center">
                    <div class="col-md-8 mb-3 mb-md-0">
                        <div class="search-container custom-search">
                            <input type="text" id="search-input" placeholder="Search products..." class="search-input" value="<%= search %>">
                            <button id="search-button" class="search-button">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                        
                    </div>
                    <div class="col-md-4 d-flex justify-content-md-end">
                        <div class="sort-options">
                            <label for="sort-by" class="text-nowrap">SORT BY:</label>
                            <select id="sort-by" class="form-select form-select-sm">
                                <option value="latest" <%= sort === 'latest' ? 'selected' : '' %>>Latest</option>
                                <option value="low-to-high" <%= sort === 'low-to-high' ? 'selected' : '' %>>Price: Low to High</option>
                                <option value="high-to-low" <%= sort === 'high-to-low' ? 'selected' : '' %>>Price: High to Low</option>
                                <option value="name-asc" <%= sort === 'name-asc' ? 'selected' : '' %>>aA - zZ</option>
                                <option value="name-desc" <%= sort === 'name-desc' ? 'selected' : '' %>>zZ - aA</option>
                            </select>
                        </div>
                        <button id="reset-filters" class="btn btn-outline-secondary btn-sm">Reset Filters</button>
                    </div>
                </div>
            </div>
    
            <div class="row">
                <!-- Desktop Filter Sidebar -->
                <div class="col-lg-3 desktop-filter">
                    <div class="filter-container">
                        <div class="filter-section">
                            <div class="filter-title">PRICE</div>
                            <input type="range" id="price-range" min="10" max="10000" value="10000" class="form-range">
                            <p class="mt-2">Price: ₹10 To 10000 <span id="price-value">10000</span>+</p>
                        </div>
    
                        <div class="filter-section">
                            <div class="filter-title">CATEGORIES</div>
                            <label><input type="checkbox" name="category" value="High Back Chairs"> High Back Chairs</label>
                            <label><input type="checkbox" name="category" value="King size beds"> King size beds</label>
                            <label><input type="checkbox" name="category" value="4 Seater Dining Sets"> 4 Seater Dining Sets</label>
                            <label><input type="checkbox" name="category" value="Fabric sofa"> Fabric sofa</label>
                            <label><input type="checkbox" name="category" value="Visitor Chairs"> Visitor Chairs</label>
                        </div>
    
                       
                        
                        
                        
                       
                    </div>
                </div>
    
                <!-- Product Grid -->
                <div class="col-lg-9">
                    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                        <% products.forEach(product => { %>
                            <% console.log(`1 - Processing product: ${product.name}`); %>
                            <div class="col">
                                <a href="/user/product/<%= product._id %>" class="text-decoration-none">
                                    <div class="product-card">
                                        <div class="product-img-container">
                                            <img src="<%= product.images.length > 0 ? product.images[0] : '/images/default.png' %>" 
                                                 class="product-img" 
                                                 alt="<%= product.name %>">
                                        </div>



                                        <div class="product-info">
                                            <h3 class="product-title"><%= product.name %></h3>
                                            <% if (product.offers && product.offers.length > 0) { %>
                                                <% console.log(`2 - Offers found for ${product.name}: ${product.offers.length}`); %>
                                                <% const bestOffer = product.offers.reduce((max, offer) => 
                                                    offer.discountValue > max.discountValue ? offer : max, product.offers[0]); %>
                                                <% const discount = bestOffer.discountValue; %>
                                                <% const discountedPrice = Math.round(product.price * (1 - discount / 100)); %>
                                                <div class="product-price">
                                                    ₹<%= discountedPrice %>
                                                    <span class="original-price"><s>₹<%= product.price %></s></span>
                                                    <span class="discount-percentage">(<%= discount %>% off)</span>
                                                </div>
                                            <% } else { %>
                                                <% console.log(`3 - No offers for ${product.name}`); %>
                                                <div class="product-price">₹<%= product.price %></div>
                                            <% } %>
                                            <% if (product.category && product.category.name) { %>
                                                <div class="product-category">Category: <%= product.category.name %></div>
                                            <% } %>
                                        </div>



                                    </div>
                                </a>
                            </div>
                        <% }); %>
                    </div>
    
                    <!-- Pagination -->
                    <div class="d-flex justify-content-center mt-4">
                        <nav aria-label="Page navigation">
                            <ul class="pagination">
                                <% if (currentPage > 1) { %>
                                    <li class="page-item">
                                        <a class="page-link" href="/user/shop?page=<%= currentPage - 1 %>&sort=<%= sort %>" aria-label="Previous">
                                            <span aria-hidden="true">&laquo;</span>
                                        </a>
                                    </li>
                                <% } %>
                        
                                <% for (let i = 1; i <= totalPages; i++) { %>
                                    <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                                        <a class="page-link" href="/user/shop?page=<%= i %>&sort=<%= sort %>"><%= i %></a>
                                    </li>
                                <% } %>
                        
                                <% if (currentPage < totalPages) { %>
                                    <li class="page-item">
                                        <a class="page-link" href="/user/shop?page=<%= currentPage + 1 %>&sort=<%= sort %>" aria-label="Next">
                                            <span aria-hidden="true">&raquo;</span>
                                        </a>
                                    </li>
                                <% } %>
                            </ul>
                        </nav>
                    </div>

                    
                </div>
            </div>
        </div>
    
        <!-- Mobile Filter Button -->
        <button class="mobile-filter-btn" id="show-filter-btn">
            <i class="fas fa-filter"></i>
        </button>
    
        <!-- Mobile Filter Sidebar -->
        <div id="mobile-filter">
            <div class="mobile-filter-header">
                <h5 class="m-0">Filters</h5>
                <button class="filter-close-btn" id="close-filter-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
    
            <div class="filter-section">
                <div class="filter-title">PRICE</div>
                <input type="range" id="mobile-price-range" min="100" max="10000" value="10000" class="form-range">
                <p class="mt-2">Price: ₹10 To 10000 <span id="mobile-price-value">10000</span>+</p>
            </div>
    
            <div class="filter-section">
                <div class="filter-title">CATEGORIES</div>
                <label><input type="checkbox" name="category" value="High Back Chairs"> High Back Chairs</label>
                <label><input type="checkbox" name="category" value="King size beds"> King size beds</label>
                <label><input type="checkbox" name="category" value="4 Seater Dining Sets"> 4 Seater Dining Sets</label>
                <label><input type="checkbox" name="category" value="Fabric sofa"> Fabric sofa</label>
            </div>
    
           
            
          
            
           
            <div class="d-grid gap-2 mt-4">
                <button class="btn btn-accent" id="apply-filter-btn">Apply Filters</button>
                <button class="btn btn-outline-secondary" id="reset-filter-btn">Reset</button>
            </div>
        </div>
        
    
        <%- include('../partials/userFooter') %>



        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>





 <script>
    document.addEventListener("DOMContentLoaded", function() {
        const categoryInputs = document.querySelectorAll('input[name="category"]');
        const brandInputs = document.querySelectorAll('input[name="brand"]');
        const priceRange = document.getElementById("price-range");
        const priceValue = document.getElementById("price-value");
        const searchInput = document.getElementById("search-input");
        const searchButton = document.getElementById("search-button");
        const sortBy = document.getElementById("sort-by");
        const resetButton = document.getElementById("reset-filters");

        // Get existing filters from URL
        const params = new URLSearchParams(window.location.search);
        const selectedCategory = params.get("category") ? params.get("category").split(",") : [];
        const selectedBrand = params.get("brand") ? params.get("brand").split(",") : [];
        const selectedPrice = params.get("price") || "10000";
        const selectedSort = params.get("sort") || "latest";
        const searchQuery = params.get("search") || "";

        // Pre-fill existing filters in the UI
        categoryInputs.forEach(input => {
            if (selectedCategory.includes(input.value)) {
                input.checked = true;
            }
        });
        brandInputs.forEach(input => {
            if (selectedBrand.includes(input.value)) {
                input.checked = true;
            }
        });
        priceRange.value = selectedPrice;
        priceValue.textContent = selectedPrice;
        sortBy.value = selectedSort;
        searchInput.value = searchQuery;

        function applyFilters() {
            let selectedCategory = [];
            categoryInputs.forEach(input => {
                if (input.checked) {
                    selectedCategory.push(input.value);
                }
            });

            let selectedBrand = [];
            brandInputs.forEach(input => {
                if (input.checked) {
                    selectedBrand.push(input.value);
                }
            });

            let selectedPrice = priceRange.value;
            let selectedSort = sortBy.value;
            let searchQuery = searchInput.value.trim();

            let queryParams = new URLSearchParams(window.location.search);
            queryParams.set("price", selectedPrice);
            queryParams.set("sort", selectedSort);
            
            if (selectedCategory.length > 0) {
                queryParams.set("category", selectedCategory.join(","));
            } else {
                queryParams.delete("category");
            }
            
            if (selectedBrand.length > 0) {
                queryParams.set("brand", selectedBrand.join(","));
            } else {
                queryParams.delete("brand");
            }
            
            if (searchQuery !== "") {
                queryParams.set("search", searchQuery);
            } else {
                queryParams.delete("search");
            }

            window.location.href = `/user/shop?${queryParams.toString()}`;
        }

        function resetFilters() {
            categoryInputs.forEach(input => {
                input.checked = false;
            });
            brandInputs.forEach(input => {
                input.checked = false;
            });
            priceRange.value = "10000";
            priceValue.textContent = "10000";
            sortBy.value = "latest";
            searchInput.value = "";
            window.location.href = "/user/shop";
        }

        // Update price value display
        priceRange.addEventListener("input", function() {
            priceValue.textContent = this.value;
        });

        // Add event listeners
        categoryInputs.forEach(input => input.addEventListener("change", applyFilters));
        brandInputs.forEach(input => input.addEventListener("change", applyFilters));
        priceRange.addEventListener("change", applyFilters);
        sortBy.addEventListener("change", applyFilters);
        searchButton.addEventListener("click", applyFilters);
        resetButton.addEventListener("click", resetFilters);

        // Search on Enter key press
        searchInput.addEventListener("keypress", function(event) {
            if (event.key === "Enter") {
                applyFilters();
            }
        });
    });
</script>



	</body>

</html>
