<!-- /*
* Bootstrap 5
* Template Name: Furni
* Template Author: Untree.co
* Template URI: https://untree.co/
* License: https://creativecommons.org/licenses/by/3.0/
*/ -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Untree.co">
  <link rel="icon" href="/images/favicon.png" type="image/png">
  <meta name="description" content="" />
  <meta name="keywords" content="bootstrap, bootstrap4" />

		<!-- Bootstrap CSS -->
		<link href="/css2/bootstrap.min.css" rel="stylesheet">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
		<link href="/css2/tiny-slider.css" rel="stylesheet">
		<link href="/css2/style.css" rel="stylesheet">
		<link href="/css2/product-page.css" rel="stylesheet">
		<title>Product Page </title>



		<style>
			/* Product Color Variants */
.product-colors {
    margin-top: 15px;
}

.section-title {
    font-size: 16px;
    font-weight: bold;
    margin-bottom: 8px;
}

.color-options {
    display: flex;
    align-items: center;
    gap: 10px;
}

.color-option {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    border: 2px solid #ddd;
    cursor: pointer;
    transition: transform 0.3s ease;
}

.color-option:hover {
    transform: scale(1.1);
}

/* Product Stock Selection */
.product-stock {
    margin-top: 15px;
}

.stock-label {
    font-size: 14px;
    font-weight: 600;
    display: block;
    margin-bottom: 5px;
}

.stock-controls {
    display: flex;
    align-items: center;
    gap: 8px;
}

.stock-btn {
    width: 30px;
    height: 30px;
    background-color: #f0f0f0;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 18px;
    cursor: pointer;
    transition: 0.3s;
}

.stock-btn:hover {
    background-color: #ddd;
}

.form-control {
    width: 50px;
    text-align: center;
    font-size: 16px;
    font-weight: bold;
    border: 1px solid #ccc;
    border-radius: 5px;
}

/* Stock Limit Message */
.stock-message {
    font-size: 12px;
    font-weight: 600;
    color: red;
    margin-top: 5px;
}

/* Product Actions */
.product-actions {
    margin-top: 15px;
    display: flex;
    gap: 10px;
}

.product-actions .btn {
    font-size: 14px;
    font-weight: 600;
    padding: 8px 15px;
    border-radius: 5px;
    transition: 0.3s ease-in-out;
}

.btn-primary {
    background-color: #007bff;
    color: white;
    border: none;
}

.btn-primary:hover {
    background-color: #0056b3;
}

.btn-secondary {
    background-color: #6c757d;
    color: white;
    border: none;
}

.btn-secondary:hover {
    background-color: #545b62;
}

		</style>
	</head>

	<body>

        <%- include('../partials/userNavbar') %>



        

		<!-- Start Hero Section -->
			<div class="hero">
				<div class="container">
					<div class="row justify-content-between">
						<div class="col-lg-5">
							<div class="intro-excerpt">
								<h1>Product</h1>
							</div>
						</div>
						<div class="col-lg-7">
							
						</div>
					</div>
				</div>
			</div>
		<!-- End Hero Section -->



		<div class="container">
			<div class="product-container">
		
				<!-- Product Images -->
				<div class="product-images">
					<img id="mainImage" 
						src="<%= product.images.length > 0 ? product.images[0] : '/images/default.png' %>" 
						alt="<%= product.name %>" 
						class="main-image"
						onmousemove="zoomImage(this, event)"
						onmouseleave="resetZoom(this)">
		
					<% if (product.images.length > 1) { %>
						<div class="thumbnail-container">
							<% product.images.slice(0, 4).forEach((img, index) => { %>
								<img src="<%= img %>" 
									alt="Thumbnail <%= index + 1 %>" 
									class="thumbnail <%= index === 0 ? 'active' : '' %>" 
									onclick="changeImage('<%= img %>')">
							<% }); %>
						</div>
					<% } %>
				</div>
		
				<!-- Product Info -->
				<div class="product-info">
					<div class="product-path">
						<a href="/user/home">Home</a> &gt; <a href="#"><%= product.category.name %></a>
					</div>
					
					<h1 class="product-title"><%= product.name %></h1>
					<div class="product-brand">Brand: <%= product.brand %></div>
		
					<div class="product-rating">
						<div class="stars">★★★★☆</div>
						<div class="review-count">245 Reviews</div>
					</div>
		
					<div class="product-price">
						<div class="current-price">₹<%= product.price %></div>
					</div>
		
					<p class="product-description"><%= product.description %></p>
		
					<div class="product-meta">
						<div class="meta-item">
							<div class="meta-label">Category:</div>
							<div class="meta-value"><%= product.category.name %></div>
						</div>
						<div class="meta-item">
							<div class="meta-label">SKU:</div>
							<div class="meta-value"><%= product.sku %></div>
						</div>
					</div>
		
					<!-- ✅ FIXED: Single Variant Support -->
					<!-- <div class="product-colors">
						<div class="section-title">Color Variants</div>
						<div class="color-options">
							<% if (product.variant && product.variant.color) { %>
								<div class="color-option" 
									 style="background-color: <%= product.variant.color %>;" 
									 title="<%= product.variant.color %>">
								</div>
							<% } else { %>
								<p>No color variants available.</p>
							<% } %>
						</div>
					</div> -->

					<div class="product-colors">
						<div class="section-title">Color Variants</div>
						<div class="color-options">
							<% if (product.variant && product.variant.color) { %>
								<div class="color-option" 
									 style="background-color: <%= product.variant.color %>;" 
									 title="<%= product.variant.color %>">
								</div>
							<% } else { %>
								<p>No variant available.</p>
							<% } %>
						</div>
					</div>
<!-- 		
					<div class="product-actions">
						<button class="btn btn-primary">Add to Cart</button>
						<button class="btn btn-secondary">Order Now</button>
					</div> -->


					<div class="product-stock">
						<label for="quantity" class="stock-label">Select Quantity:</label>
						<div class="stock-controls">
							<button type="button" class="stock-btn" onclick="updateStock(-1)">−</button>
							<input type="number" id="quantity" name="quantity" value="1" min="1" max="3" class="form-control" readonly>
							<button type="button" class="stock-btn" onclick="updateStock(1)">+</button>
						</div>
						<p id="stock-message" class="stock-message" style="color: red; display: none;">Max 3 stocks per user</p>
					</div>
					
					<div class="product-actions">
						<form action="/user/cart/add" method="POST" onsubmit="event.stopPropagation();">
							<input type="hidden" name="productId" value="<%= product._id %>">
							<input type="hidden" name="color" value="<%= product.variant ? product.variant.color : '' %>">
							<input type="hidden" name="quantity" id="finalQuantity" value="1">
					
							<button type="submit" class="btn btn-primary">Add to Cart</button>
						</form>
						<button class="btn btn-secondary">Order Now</button>
					</div>


				</div>
			</div>
		
			<!-- Related Products Section -->
			 <div class="related-products">
        <h2 class="related-title">Related Products</h2>
		<div class="related-products-container">
			<% if (relatedProducts && relatedProducts.length > 0) { %>
				<% relatedProducts.forEach(product => { %>
					<div class="related-product-card" onclick="window.location.href='/user/product/<%= product._id %>'" style="cursor: pointer;">
						<img src="<%= product.images && product.images.length > 0 ? product.images[0] : '/images/default.png' %>"
							 alt="<%= product.name %>"
							 class="related-product-image">
						<div class="related-product-name"><%= product.name %></div>
						<div class="related-product-price">₹<%= product.price %></div>
		
						<!-- Add to Cart Form -->
						<form action="/user/cart/add" method="POST" onsubmit="event.stopPropagation();">
							<input type="hidden" name="productId" value="<%= product._id %>">
							<input type="hidden" name="color" value="<%= product.variant ? product.variant.color : '' %>">
							<input type="hidden" name="quantity" value="1" min="1" class="form-control">
							<button type="submit" class="btn btn-primary">Add to Cart</button>
						</form>
					</div>
				<% }) %>
			<% } else { %>
				<p>No related products available.</p>
			<% } %>
		</div>
		
    </div>
</div>









     



			






		<!-- Start Footer Section -->
		<footer class="footer-section">
			<div class="container relative">

			
				<div class="row">
					<div class="col-lg-8">
						<div class="subscription-form">
							<h3 class="d-flex align-items-center"><span class="me-1"><img src="images/envelope-outline.svg" alt="Image" class="img-fluid"></span><span>Subscribe to Newsletter</span></h3>

							<form action="#" class="row g-3">
								<div class="col-auto">
									<input type="text" class="form-control" placeholder="Enter your name">
								</div>
								<div class="col-auto">
									<input type="email" class="form-control" placeholder="Enter your email">
								</div>
								<div class="col-auto">
									<button class="btn btn-primary">
										<span class="fa fa-paper-plane"></span>
									</button>
								</div>
							</form>

						</div>
					</div>
				</div>

				<div class="row g-5 mb-5">
					<div class="col-lg-4">
						<div class="mb-4 footer-logo-wrap"><a href="#" class="footer-logo">Supreme<span>.</span></a></div>
						<p class="mb-4">Donec facilisis quam ut purus rutrum lobortis. Donec vitae odio quis nisl dapibus malesuada. Nullam ac aliquet velit. Aliquam vulputate velit imperdiet dolor tempor tristique. Pellentesque habitant</p>

						<ul class="list-unstyled custom-social">
							<li><a href="#"><span class="fa fa-brands fa-facebook-f"></span></a></li>
							<li><a href="#"><span class="fa fa-brands fa-twitter"></span></a></li>
							<li><a href="#"><span class="fa fa-brands fa-instagram"></span></a></li>
							<li><a href="#"><span class="fa fa-brands fa-linkedin"></span></a></li>
						</ul>
					</div>

					<div class="col-lg-8">
						<div class="row links-wrap">
							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">About us</a></li>
									<li><a href="#">Services</a></li>
									<li><a href="#">Blog</a></li>
									<li><a href="#">Contact us</a></li>
								</ul>
							</div>

							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">Support</a></li>
									<li><a href="#">Knowledge base</a></li>
									<li><a href="#">Live chat</a></li>
								</ul>
							</div>

							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">Jobs</a></li>
									<li><a href="#">Our team</a></li>
									<li><a href="#">Leadership</a></li>
									<li><a href="#">Privacy Policy</a></li>
								</ul>
							</div>

							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">Nordic Chair</a></li>
									<li><a href="#">Kruzo Aero</a></li>
									<li><a href="#">Ergonomic Chair</a></li>
								</ul>
							</div>
						</div>
					</div>

				</div>

				<div class="border-top copyright">
					<div class="row pt-4">
						<div class="col-lg-6">
							<p class="mb-2 text-center text-lg-start">Copyright &copy;<script>document.write(new Date().getFullYear());</script>. All Rights Reserved. &mdash; Designed with love by <a href="https://untree.co">Untree.co</a>  Distributed By <a href="https://themewagon.com">ThemeWagon</a> <!-- License information: https://untree.co/license/ -->
            </p>
						</div>

						<div class="col-lg-6 text-center text-lg-end">
							<ul class="list-unstyled d-inline-flex ms-auto">
								<li class="me-4"><a href="#">Terms &amp; Conditions</a></li>
								<li><a href="#">Privacy Policy</a></li>
							</ul>
						</div>

					</div>
				</div>

			</div>
		</footer>
		<!-- End Footer Section -->	
		<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

		<script src="js/bootstrap.bundle.min.js"></script>
		<script src="js/tiny-slider.js"></script>
		<script src="js/custom.js"></script>



		<script>

function changeImage(newImage) {
    let mainImage = document.getElementById("mainImage");
    let thumbnails = document.querySelectorAll(".thumbnail");

    // Swap main image
    mainImage.src = newImage;

    // Remove 'active' class from all thumbnails
    thumbnails.forEach(thumbnail => thumbnail.classList.remove("active"));

    // Add 'active' class to clicked thumbnail
    thumbnails.forEach(thumbnail => {
        if (thumbnail.src === newImage) {
            thumbnail.classList.add("active");
        }
    });
}




function zoomImage(imageElement, event) {
    const rect = imageElement.getBoundingClientRect();
    const x = event.clientX - rect.left;
    const y = event.clientY - rect.top;

    const xPercent = (x / rect.width) * 100;
    const yPercent = (y / rect.height) * 100;

    imageElement.style.transformOrigin = `${xPercent}% ${yPercent}%`;
    imageElement.style.transform = "scale(2.0)";
    imageElement.style.cursor = "zoom-in";
  }

  function resetZoom(imageElement) {
    imageElement.style.transform = "scale(1)";
    imageElement.style.cursor = "default";
  }

  function changeImage(imageSrc) {
    const mainImage = document.getElementById('mainImage');
    mainImage.src = imageSrc;
    resetZoom(mainImage);
  }








function addToCart(productId) {
    fetch('/user/cart/add', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ productId: productId })
    })
    .then(response => {
        if (response.redirected) {
            window.location.href = response.url; // Follow redirect to cart page
        }
    })
    .catch(error => console.error('Error:', error));
}
    
	
	
	
function updateStock(change) {
        let quantityInput = document.getElementById('quantity');
        let finalQuantityInput = document.getElementById('finalQuantity');
        let stockMessage = document.getElementById('stock-message');
        
        let currentValue = parseInt(quantityInput.value);
        let newValue = currentValue + change;

        if (newValue >= 1 && newValue <= 3) {
            quantityInput.value = newValue;
            finalQuantityInput.value = newValue;
            stockMessage.style.display = 'none';
        } else if (newValue > 3) {
            stockMessage.style.display = 'block';
        }
    }</script>

	</body>

</html>
