<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Address Book | Furniture E-commerce</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
   
 <!-- Bootstrap 5.3 CSS -->
 <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
 <!-- Bootstrap Icons -->
 <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.0/font/bootstrap-icons.min.css"
     rel="stylesheet">
 <!-- <link rel="stylesheet" href="/css/address.css"> -->



 <style>


/* Address Book Page Styles */
.account-container {
  max-width: 1200px;
  margin: 40px auto;
  padding: 0 15px;
}

.page-title {
  font-size: 28px;
  font-weight: 600;
  margin-bottom: 30px;
  border-bottom: 1px solid #eaeaea;
  padding-bottom: 15px;
}

/* Sidebar Styles */
.sidebar {
  background-color: #f8f9fa;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 30px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.sidebar-section {
  margin-bottom: 25px;
}

.sidebar-title {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 15px;
  color: #333;
  border-bottom: 1px solid #eaeaea;
  padding-bottom: 10px;
}

.sidebar-menu {
  list-style: none;
  padding: 0;
  margin: 0;
}

.sidebar-menu li {
  margin-bottom: 10px;
}

.sidebar-menu a {
  display: flex;
  align-items: center;
  color: #555;
  text-decoration: none;
  padding: 8px 10px;
  border-radius: 6px;
  transition: all 0.2s ease;
}

.sidebar-menu a:hover {
  background-color: #f1f1f1;
  color: #111;
}

.sidebar-menu a.active {
  background-color: #e9ecef;
  color: #000;
  font-weight: 500;
}

.sidebar-menu a i {
  margin-right: 10px;
  width: 20px;
  text-align: center;
}

.invite-subtitle {
  font-size: 12px;
  color: #888;
  margin: 0 0 0 30px;
  padding: 0;
}

/* Address Book Container Styles */
.addresses-container {
  background-color: #fff;
  border-radius: 8px;
  padding: 25px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.addresses-container h2 {
  font-size: 22px;
  font-weight: 600;
  color: #333;
  margin-bottom: 0;
}

/* Address Card Styles */
.address-card {
  border: 1px solid #eaeaea;
  border-radius: 8px;
  padding: 20px;
  position: relative;
  transition: all 0.2s ease;
  height: 100%;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  background-color: #fff;
}

.address-card:hover {
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  border-color: #ddd;
}

.address-type {
  position: absolute;
  top: 15px;
  right: 15px;
  padding: 4px 10px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 500;
}

.address-type-home {
  background-color: #e7f5ff;
  color: #1971c2;
}

.address-type-work {
  background-color: #fff9db;
  color: #e6a700;
}

.default-badge {
  position: absolute;
  top: 15px;
  left: 15px;
  background-color: #ebfbee;
  color: #2b8a3e;
  padding: 4px 10px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 500;
}

.address-name {
  font-size: 18px;
  font-weight: 600;
  margin: 25px 0 15px;
  color: #333;
}

.address-details {
  color: #666;
  margin-bottom: 5px;
  font-size: 14px;
  line-height: 1.5;
}

.address-actions {
  margin-top: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.address-actions .btn {
  padding: 6px 12px;
  border-radius: 6px;
}

.btn-accent {
  background-color: #228be6;
  border-color: #228be6;
  color: #fff;
}

.btn-accent:hover {
  background-color: #1c7ed6;
  border-color: #1c7ed6;
  color: #fff;
}

.btn-outline-accent {
  color: #228be6;
  border-color: #228be6;
  background-color: transparent;
}

.btn-outline-accent:hover {
  background-color: #e7f5ff;
  color: #1971c2;
  border-color: #1971c2;
}

.btn-icon {
  padding: 6px 12px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.btn-delete {
  color: #e03131;
  border-color: #e03131;
}

.btn-delete:hover {
  background-color: #ffe3e3;
  color: #c92a2a;
  border-color: #c92a2a;
}

/* Modal Styles */
.modal-content {
  border: none;
  border-radius: 10px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.modal-header {
  border-bottom: 1px solid #eaeaea;
  padding: 15px 20px;
}

.modal-title {
  font-weight: 600;
  color: #333;
}

.modal-body {
  padding: 20px;
}

.modal-footer {
  border-top: 1px solid #eaeaea;
  padding: 15px 20px;
}

/* Form Styles */
.form-floating > .form-control {
  padding: 1rem 0.75rem;
}

.form-floating > .form-control:focus {
  border-color: #228be6;
  box-shadow: 0 0 0 0.25rem rgba(34, 139, 230, 0.25);
}

.form-floating > label {
  padding: 1rem 0.75rem;
}

.form-check-input:checked {
  background-color: #228be6;
  border-color: #228be6;
}

/* Custom buttons for modals */
.modal .btn-primary {
  background-color: #228be6;
  border-color: #228be6;
}

.modal .btn-primary:hover {
  background-color: #1c7ed6;
  border-color: #1c7ed6;
}

.modal .btn-outline-primary {
  color: #228be6;
  border-color: #228be6;
}

.modal .btn-outline-primary:hover {
  background-color: #e7f5ff;
  color: #1971c2;
  border-color: #1971c2;
}

.modal .btn-danger {
  background-color: #e03131;
  border-color: #e03131;
}

.modal .btn-danger:hover {
  background-color: #c92a2a;
  border-color: #c92a2a;
}

/* Alert styling */
.alert-info {
  background-color: #e7f5ff;
  border-color: #d0ebff;
  color: #1971c2;
}

/* Responsive styles */
@media (max-width: 991.98px) {
  .address-card {
    margin-bottom: 20px;
  }
}

@media (max-width: 767.98px) {
  .addresses-container h2 {
    font-size: 20px;
  }
  
  .address-card {
    padding: 15px;
  }
  
  .address-name {
    font-size: 16px;
    margin-top: 30px;
  }
  
  .btn {
    font-size: 14px;
    padding: 5px 10px;
  }
  
  .address-actions {
    flex-wrap: wrap;
    gap: 10px;
  }
  
  .address-actions .btn {
    flex: 1;
  }
}

@media (max-width: 575.98px) {
  .account-container {
    margin: 20px auto;
  }
  
  .page-title {
    font-size: 24px;
    margin-bottom: 20px;
    padding-bottom: 10px;
  }
  
  .addresses-container {
    padding: 15px;
  }
  
  .d-flex.justify-content-between.align-items-center {
    flex-direction: column;
    gap: 15px;
    align-items: flex-start !important;
  }
  
  .d-flex.justify-content-between.align-items-center .btn {
    width: 100%;
  }
  
  .modal-dialog {
    margin: 1rem;
  }
}

/* Animation for modal */
.modal.fade .modal-dialog {
  transition: transform 0.3s ease-out;
}

.modal.fade .modal-dialog {
  transform: translateY(-20px);
}

.modal.show .modal-dialog {
  transform: translateY(0);
}

/* Toast Notifications */
.toast-container {
  position: fixed;
  bottom: 20px;
  right: 20px;
  z-index: 1060;
}

.toast {
  background-color: #fff;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  overflow: hidden;
  border-left: 4px solid #228be6;
}

.toast-success {
  border-left-color: #40c057;
}

.toast-error {
  border-left-color: #e03131;
}

.toast-header {
  border-bottom: 1px solid #eaeaea;
  background-color: #fff;
}

.toast-body {
  padding: 12px;
}

 </style>
</head>

<body>

 <%- include('../partials/userNavbar') %>
    <div class="account-container">
        <h1 class="page-title">My Account</h1>
        
        <div class="row">
            <!-- Sidebar - My Account Section -->
            <div class="col-lg-3 col-md-4">
                <div class="sidebar">
                    <!-- Orders Section -->
                    <div class="sidebar-section">
                        <h3 class="sidebar-title">My Account</h3>
                        <ul class="sidebar-menu">
                            <li>
                                <a href="/user/account" class="active">
                                    <i class="fas fa-box"></i> Orders
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <i class="fas fa-wallet"></i> Wallet
                                </a>
                            </li>
                             <li>
                                <a href="/user/referral">
                                    <i class="fas fa-user-plus"></i> Invite Friends
                                </a>
                                <p class="invite-subtitle">Earn 50 points for every friend</p>
                            </li> 
                            
                        </ul>
                    </div>
                    
                    <!-- Profile Section -->
                    <div class="sidebar-section">
                        <h3 class="sidebar-title">Profile</h3>
                        <ul class="sidebar-menu">
                            <li>
                                <a href="/user/profile">
                                    <i class="fas fa-user"></i> Personal Information
                                </a>
                            </li>
                            <li>
                                <a href="#" class="active">
                                    <i class="fas fa-address-book"></i> Address Book
                                </a>
                            </li>
                           
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Main Content - Address Book Section -->
            <div class="col-lg-9 col-md-8">
                <div class="addresses-container">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2>Address Book</h2>
                        <button class="btn btn-accent" data-bs-toggle="modal" data-bs-target="#addAddressModal">
                            <i class="fas fa-plus me-2"></i> Add New Address
                        </button>
                    </div>
                    
                   

                    <div class="row">
                        <% if (addresses.length > 0) { %>  
                            <% addresses.forEach(address => { %>
                                <div class="col-lg-6 col-md-12 mb-4">
                                    <div class="address-card">
                                        <span class="address-type address-type-<%= address.addressType.toLowerCase() %>">
                                            <%= address.addressType %>
                                        </span>
                                        <% if (address.isDefault) { %>
                                            <span class="default-badge">Default</span>
                                        <% } %>
                    
                                        <h4 class="address-name"><%= address.fullName %></h4>
                                        <p class="address-details"><%= address.phone %></p>
                                        <p class="address-details"><%= address.address %></p>
                                        <p class="address-details"><%= address.city %>, <%= address.state %> <%= address.pincode %></p>
                                        <p class="address-details"><%= address.country %></p>
                    
                                        <div class="address-actions">
                                            <button class="btn btn-sm btn-outline-accent" 
                                                    data-bs-toggle="modal" 
                                                    data-bs-target="#editAddressModal" 
                                                    onclick="loadAddressData('/user/address/<%= address._id %>')">
                                                <i class="fas fa-edit me-1"></i> Edit
                                            </button>
                    
                                            <button class="btn btn-outline-primary btn-icon btn-delete"
                                                    data-bs-toggle="modal" 
                                                    data-bs-target="#deleteAddressModal"
                                                    onclick="$('#deleteAddressModal').data('addressId', '<%= address._id %>')">
                                                <i class="bi bi-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            <% }); %>
                        <% } else { %>
                            <div class="col-12 text-center">
                                <p class="alert alert-info">No addresses found. Please add a new address.</p>
                            </div>
                        <% } %>
                    </div>
                    


                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Address Modal -->



    <div class="modal fade" id="addAddressModal" tabindex="-1" aria-labelledby="addAddressModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addAddressModalLabel">Add New Address</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addressForm">
                        <div class="row g-3">
                            <div class="col-md-6"><div class="form-floating"><input type="text" class="form-control" id="fullName" placeholder="Full Name"><label for="fullName">Full Name</label></div></div>
                            <div class="col-md-6"><div class="form-floating"><input type="tel" class="form-control" id="phone" placeholder="Phone Number"><label for="phone">Phone Number</label></div></div>
                            <div class="col-12"><div class="form-floating"><input type="text" class="form-control" id="address" placeholder="Address"><label for="address">Address</label></div></div>
                            <div class="col-md-6"><div class="form-floating"><input type="text" class="form-control" id="city" placeholder="City"><label for="city">City</label></div></div>
                            <div class="col-md-6"><div class="form-floating"><input type="text" class="form-control" id="state" placeholder="State/Province"><label for="state">State/Province</label></div></div>
                            <div class="col-md-6"><div class="form-floating"><input type="text" class="form-control" id="country" placeholder="Country"><label for="country">Country</label></div></div>
                            <div class="col-md-6"><div class="form-floating"><input type="text" class="form-control" id="pincode" placeholder="Postal/Zip Code"><label for="pincode">Postal/Zip Code</label></div></div>
                            <div class="col-md-6"><div class="form-floating"><select class="form-select" id="addressType"><option value="Home" selected>Home</option><option value="Work">Work</option></select><label for="addressType">Address Type</label></div></div>
                            <div class="col-md-6 d-flex align-items-center ps-4"><div class="form-check"><input class="form-check-input" type="checkbox" id="setDefault"><label class="form-check-label" for="setDefault">Set as default address</label></div></div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveAddressBtn">Save Address</button>
                </div>
            </div>
        </div>
    </div>

   


    <div class="modal fade" id="editAddressModal" tabindex="-1" aria-labelledby="editAddressModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editAddressModalLabel">Edit Address</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editAddressForm" autocomplete="off">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="editFullName" placeholder="Full Name" required>
                                    <label for="editFullName">Full Name</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="tel" class="form-control" id="editPhone" placeholder="Phone Number" required>
                                    <label for="editPhone">Phone Number</label>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="editAddress" placeholder="Address" required>
                                    <label for="editAddress">Address</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="editCity" placeholder="City" required>
                                    <label for="editCity">City</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="editState" placeholder="State/Province" required>
                                    <label for="editState">State</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="editCountry" placeholder="Country" required>
                                    <label for="editCountry">Country</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="number" class="form-control" id="editPincode" placeholder="Postal/Zip Code" required>
                                    <label for="editPincode">Pin Code</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <select class="form-select" id="editAddressType" required>
                                        <option value="Home">Home</option>
                                        <option value="Work">Work</option>
                                    </select>
                                    <label for="editAddressType">Address Type</label>
                                </div>
                            </div>
                            <div class="col-md-6 d-flex align-items-center ps-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="editSetDefault">
                                    <label class="form-check-label" for="editSetDefault">Set as default address</label>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="updateAddressBtn">Update Address</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Delete Address Modal -->
    <div class="modal fade" id="deleteAddressModal" tabindex="-1" aria-labelledby="deleteAddressModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteAddressModalLabel">Delete Address</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete this address? This action cannot be undone.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" onclick="deleteAddress()">Delete Address</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Set Default Address Modal -->
    <div class="modal fade" id="setDefaultModal" tabindex="-1" aria-labelledby="setDefaultModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="setDefaultModalLabel">Set as Default Address</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to set this address as your default address?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-accent" onclick="setDefaultAddress()">Set as Default</button>
                </div>
            </div>
        </div>
    </div>
    <%- include('../partials/userFooter') %>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

     <!-- Bootstrap JS and dependencies -->
     <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
     <!-- Bootstrap JS if you're using modals -->
     <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script> -->

     <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
     <script src="/js/address.js"></script>
   
</body>
</html>